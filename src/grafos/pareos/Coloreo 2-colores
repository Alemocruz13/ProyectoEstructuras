from collections import deque

def es_bipartito_general(edges, dirigido=False, ponderado=False):
    """
    Determina si un grafo es bipartito usando coloreo de 2 colores.
    
    edges: lista de aristas
        - No ponderado: [(u,v), ...]
        - Ponderado: [(u,v,w), ...] donde w es el peso
    dirigido: True si el grafo es dirigido
    ponderado: True si las aristas tienen peso
    Retorna True si es bipartito, False si no lo es.
    """
    # Construimos la lista de adyacencia
    grafo = {}
    for edge in edges:
        u, v = edge[:2]  # ignoramos el peso si lo hay
        if u not in grafo:
            grafo[u] = []
        grafo[u].append(v)
        if not dirigido:
            if v not in grafo:
                grafo[v] = []
            grafo[v].append(u)
    
    color = {}

    for nodo in grafo:
        if nodo not in color:
            color[nodo] = 0
            cola = deque([nodo])

            while cola:
                actual = cola.popleft()
                for vecino in grafo[actual]:
                    if vecino not in color:
                        color[vecino] = 1 - color[actual]
                        cola.append(vecino)
                    elif color[vecino] == color[actual]:
                        return False
    return True

# Ejemplos de uso:

# Grafo no dirigido, no ponderado
edges1 = [(0,1),(1,2),(2,3),(3,0)]
print(es_bipartito_general(edges1))  # True

# Grafo dirigido, ponderado
edges2 = [(0,1,5),(1,2,3),(2,3,2),(3,0,4)]
print(es_bipartito_general(edges2, dirigido=True, ponderado=True))  # False
